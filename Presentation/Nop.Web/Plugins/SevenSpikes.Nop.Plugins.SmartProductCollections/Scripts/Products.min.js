/*
* Copyright 2016 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

!function (a) { function f(b, c) { var d = a("img", b), e = d.length; 0 === e && c.find(".loading-overlay").fadeOut(), d.load(function () { e--, e <= 0 && c.find(".loading-overlay").fadeOut() }) } var b = a(window), c = function () { 0 === a(".spc-products[notLoaded], .spc-categories[notLoaded]").length && b.off("scroll.smart-products") }, d = function () { var d = b.scrollTop() + b.outerHeight(); a(".spc-products[notLoaded]").each(function () { var b = a(this); b.offset().top < d && (b.removeAttr("notLoaded"), b.find(".tab:first").click()) }), a(".spc-categories[notLoaded]").each(function () { var b = a(this); b.offset().top < d && (b.removeAttr("notLoaded"), a.ajax({ url: b.attr("data-getCategoryGroupInfoUrl"), type: "POST", data: { categoryId: parseInt(b.attr("data-categoryGroupId")) || 0 } }).done(function (c) { b.html(c), b.find(".navigation .tab:first-of-type").removeAttr("notLoaded").addClass("active"), b.find(".category-products .product-grid:first-of-type").addClass("active"), a.event.trigger({ type: "newProductsAddedToPageEvent" }) }).fail(function () { b.remove() })) }), c() }, e = function () { a(".spc-products .tab").off("click.smartproductcollections").on("click.smartproductcollections", function (b) { b.preventDefault(); var c = a(this), d = parseInt(c.attr("data-tabId")); if (!isNaN(d)) { var e = c.closest(".spc-products"); c.hasClass("loaded") ? (c.addClass("active").siblings(".tab").removeClass("active"), e.find('.spc-body .product-grid[data-tabId="' + d + '"]').addClass("active").siblings(".product-grid").removeClass("active")) : (c.addClass("loaded"), e.find(".loading-overlay").show(), a.ajax({ url: e.attr("data-getItemProductsUrl"), type: "POST", data: { id: d } }).done(function (b) { var g = e.find('.spc-body .product-grid[data-tabId="' + d + '"]'); g.find(".item-grid").html(b), c.addClass("active").siblings(".tab").removeClass("active"), g.addClass("active").siblings(".product-grid").removeClass("active"), f(g, e), a.event.trigger({ type: "newProductsAddedToPageEvent" }) })) } }), a(".spc-categories").on("click", ".navigation .tab", function () { var b = a(this), c = parseInt(b.attr("data-tabId")) || 0, d = b.closest(".spc-categories"), e = parseInt(d.attr("data-categoryGroupId")) || 0, g = d.find('.category-products .product-grid[data-tabId="' + c + '"]'); b.is("[notLoaded]") ? (b.removeAttr("notLoaded"), d.find(".loading-overlay").show(), a.ajax({ url: d.attr("data-getItemProductsUrl"), type: "POST", data: { id: c, categoryId: e } }).done(function (c) { g.children(".item-grid").html(c), b.addClass("active").siblings(".tab").removeClass("active"), g.addClass("active").siblings(".product-grid").removeClass("active"), f(g, d), a.event.trigger({ type: "newProductsAddedToPageEvent" }) })) : (b.addClass("active").siblings(".tab").removeClass("active"), g.addClass("active").siblings(".product-grid").removeClass("active")), d.find('.category-mobile-navigation-select option[value="' + c + '"]').attr("selected", "selected") }), a(".spc-categories").on("change", ".category-mobile-navigation-select", function () { var b = a(this); b.closest(".spc-categories").find('.navigation .tab[data-tabId="' + b.val() + '"]').click() }) }; a(document).ready(function () { e(), setTimeout(d, 200), b.on("scroll.smart-products", d) }) }(jQuery);