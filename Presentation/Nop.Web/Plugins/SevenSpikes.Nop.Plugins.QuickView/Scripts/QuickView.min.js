/*
* Copyright 2016 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

(function (n, t) { function u() { var t = n(".quickViewWindow").data("kendoWindow"); t != undefined && t.content() !== "" && t.close() } function o() { var t = n(".quickViewWindow").data("kendoWindow"), i = n("<div class='k-loading-mask'><div class='k-loading-image'/><div class='k-loading-color'/><\/div>").width("700px").height("360px"); t.content(i); t.center(); t.open() } function s(t) { var i = n(".quickViewWindow").data("kendoWindow"); i.content(t) } function h() { var t = n(".quickViewAdjustPictureOnProductAttributeValueChange"); if (t.length > 0) n(document).on("quickView.product_attributes_changed", function (i) { if (i.changedData && i.changedData.pictureDefaultSizeUrl) { var r = i.changedData.pictureDefaultSizeUrl; t.attr("data-isCloudZoomAvailable") === "true" ? (r = r.substring(1, r.length - 9), n('.quickViewWindow .cloudzoom-gallery[href*="' + r + '"]').click()) : n(".quickViewWindow .gallery .picture img").attr("src", r) } }) } function c() { var t = n(".quickViewRentalInfo"); if (t.length > 0) { var i = t.attr("data-datePickerFormat"), r = "#" + t.attr("data-startDateControlId"), u = "#" + t.attr("data-endDateControlId"); n(r).datepicker({ dateFormat: i }); n(u).datepicker({ dateFormat: i }) } } function l(t) { var i = n(".quickViewData").attr("data-retrieveQuickViewUrl"), r; i != undefined && (r = { productID: t }, n.ajax({ beforeSend: function () { o() }, cache: !1, type: "POST", data: n.toJSON(r), contentType: "application/json; charset=utf-8", url: i }).done(function (t) { var r, u, f, i; s(t); r = { header: "ui-icon-circle-arrow-e", activeHeader: "ui-icon-circle-arrow-s" }; u = n(".quickViewData").attr("data-accordionpanelsheightstyle"); n("#accordion").accordion({ collapsible: !0, icons: r, heightStyle: u }); f = n(".quickView").offset(); i = n(".quickView").height(); n(window).height() < i ? n(".quickView").css("top", n(document).scrollTop() + 10) : n(".quickView").css("top", f.top - i / 4); h(); c(); n.event.trigger({ type: "nopQuickViewDataShownEvent" }) }).fail(function () { alert("Loading the page failed."); u() })) } function f(t, u) { var f = n(".quickViewData").attr("data-quickViewButtonText"), o = n(".quickViewData").attr("data-quickViewButtonTitle"), e; f == undefined && (f = "Quick View"); e = n(u); n(e).each(function () { n(this).find(r).length <= 0 && n(this).prepend('<div class="' + i + '"><a title="' + o + '">' + f + "<\/a><\/div>") }); n(r).off("click.quickview").on("click.quickview", function () { var i = n(this).parents(t).first().attr("data-productid"); typeof i != "undefined" && l(i) }); n.event.trigger({ type: "nopQuickViewButtonsAddedCompleteEvent" }) } function a() { var t = n(".quickViewData").attr("data-isQuickViewPopupDraggable"); return t != undefined && t === "True" ? !0 : !1 } function v() { var t = n(".quickViewData").attr("data-enableQuickViewPopupOverlay"); return t != undefined && t === "True" ? !0 : !1 } function y() { var t = n("body"), i; if (t.length > 0) { i = '<div class="quickViewWindow"><\/div>'; t.prepend(i); var u = a(), f = v(), r = n(".quickViewWindow").kendoWindow({ minHeight: "330px", minWidth: "660px", draggable: u, resizable: !1, modal: f, actions: ["Close"], animation: !1, visible: !1, close: function () { n(".quickViewWindow").html(n("").html()) } }).data("kendoWindow"); r.wrapper.addClass("quickView"); n(document).on("click", ".k-overlay", function () { r.close() }) } } function p() { var t = n(".quickViewData").attr("data-productselector"); return t != undefined ? t : "" } function e(t) { var i = n(".quickViewData").attr("data-productselectorchild"); return typeof i != "undefined" && i !== t && n(t + " " + i).length > 0 ? t + " " + i : t } var i = "quick-view-button", r = "." + i; n(document).on("nopQuickViewDataShownEvent", function () { var i = n("#add-to-cart-details").attr("data-productid"), t = ".quickViewWindow #add-to-cart-button-" + i; if (!n(t).hasClass("nopAjaxCartProductVariantAddToCartButton")) { n(t).prop("onclick", null).off("click"); n(t).on("click", function () { var i = n("#add-to-cart-details").attr("data-url"), t = n(".quickViewWindow #product-details-form").serialize(); t = t.replace(new RegExp("quickView_product_attribute", "g"), "product_attribute"); n.ajax({ cache: !1, url: i, data: t, type: "post", success: AjaxCart.success_process, complete: AjaxCart.resetLoadWaiting, error: AjaxCart.ajaxFailure }) }) } }); n(document).ready(function () { var i, r; if (!t.isMobile() && (t.isMobile() || !(t.getViewPort().width <= 768)) && (i = p(), i !== "")) { r = e(i); f(i, r); n(document).on("nopAjaxCartProductAddedToCartEvent nopAjaxCartProductAddedToWishlistEvent", function () { u() }); n(document).on("nopAjaxFiltersFiltrationCompleteEvent newProductsAddedToPageEvent", function () { r = e(i); f(i, r) }); y() } }) })(jQuery, sevenSpikes);